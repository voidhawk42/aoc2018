⎕IO←0
p r←{⍎¨⍵(∊⊆⊣)⎕D}⊃⊃⎕nget'p9.txt'1
t←{a←⍬ ⋄ a⊣⍺{a,←⍺⍵⌷m}⍣⍵⊢c}
i←{l r←1 t 2 ⋄ m[(1 l)(0 r)]←⍵ ⋄ m[;⍵]←l r ⋄ c⊢←⍵}
d←{r a l←¯3↑0 t 8 ⋄ m[(1 l)(0 r)]←r l ⋄ s[p|⍵]+←a+⍵ ⋄ c⊢←r}
g←{0=23|⍵:d⍵ ⋄ i⍵}
m←⍪2 (r+1)⍴0 ⋄ c←0 ⋄ s←p⍴0 ⋄ ⌈/s⊣g¨1+⍳r ⍝ part 1
r×←100 ⋄ m←⍪2 (r+1)⍴0 ⋄ c←0 ⋄ s←p⍴0 ⋄ ⌈/s⊣g¨1+⍳r ⍝ part 2
