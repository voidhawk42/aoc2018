⎕IO←0
p r←{⍎¨⍵(∊⊆⊣)⎕D}⊃⊃⎕nget'p9.txt'1
m←0⍴⍨2,1+r×100 ⋄ c←0 ⋄ s←p⍴0
t←{⊢c⊢←⍺{⍺⍵⌷m}⍣⍵⊢c}
i←{l r←1∘t¨1 1 ⋄ m[(1 l)(0 r)]←⍵ ⋄ m[;⍵]←l r ⋄ c⊢←⍵}
d←{r a l←0∘t¨6 1 1 ⋄ m[(1 l)(0 r)]←r l ⋄ s[p|⍵]+←a+⍵ ⋄ c⊢←r}
f←{⌈/s⊣{0=23|⍵:⍵+1⊣d⍵ ⋄ ⍵+1⊣i⍵}⍣⍺⊢⍵}
r f 1 ⍝ part 1
(r×99) f r+1 ⍝ part 2
