s←⍎⊃⊃⎕nget'p11.txt'1
m←{y r←0 10+⍵ ⋄ 5-⍨⊃(3⍴10)⊤r×s+y×r}¨⍳2⍴300
f←{⍵,⍨{a,⌽⊃⍸⍵=a←⌈/,⍵}(-d)↓(d←2⍴⌊2÷⍨⍵-1)↓{+/,⍵}⌺⍵ ⍵⊢m}
(f 3)[2 3] ⍝ part 1
{1↓(⊃⍒⍵)⌷⍵}↑f¨⍳300 ⍝ part 2
